
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

        <script async src="https://www.googletagmanager.com/gtag/js?id=G-FYHS50G6DL"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            
            gtag('config', 'G-FYHS50G6DL');
            
        </script>
    
    <title>我如何用 Sphinx 建立笔记系统（一）选择 Sphinx 的理由 &#8212; 银色子弹</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxnotes-strike.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster-custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/ablog.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.2/css/all.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <script data-isso="https://comments.silverrainz.me:30500" src="https://comments.silverrainz.me:30500/js/embed.min.js"></script>
    <link rel="canonical" href="https://silverrainz.me/blog/sphinx-as-note-taking-system.html" />
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" /> 
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
    <link rel="apple-touch-icon" href="../_static/logo.png" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />
 
<link
  rel="alternate"
  type="application/atom+xml"
  href="../blog/atom.xml"
  title="银色子弹"
/>
 
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
             <section id="sphinx-sphinx">
<h1>我如何用 Sphinx 建立笔记系统（一）选择 Sphinx 的理由<a class="headerlink" href="#sphinx-sphinx" title="永久链接至标题">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>这是《我如何用 Sphinx 建立笔记系统》系列的第 <em>一</em> 篇。</p>
</div>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>这个笔记系统是带有强烈个人色彩的场景中中诞生的，并不适合所有人，你可以先了解一下我的 <a class="reference internal" href="#id5"><span class="std std-ref">场景</span></a> ，再决定是否继续阅读。另，开头讲了一些关于笔记的无聊往事，如果想跳过，也可以直接从 <a class="reference internal" href="#id5"><span class="std std-ref">场景</span></a> 开始阅读</p>
</div>
<blockquote>
<div><p><a class="reference internal" href="../about/me.html#friend-SilverRainZ" title="friend SilverRainZ"><code class="xref any any-friend docutils literal notranslate"><span class="pre">👤SilverRainZ</span></code></a> （指我自己）在使用一个还未存在的自建笔记系统，每次想写点东西都因为「无法解决依赖」而失败。 <a class="footnote-reference brackets" href="#id18" id="id1">1</a></p>
</div></blockquote>
<p>不知何时我养成了一种奇怪的癖好，想读一本有价值的书，没有合适工具记读书笔记，所以不读。 想记录一些不成体系的知识，不知道如何组织分类这些碎片，所以不记。想写一篇博客，文章里有一些交叉引用，不想用粗暴的 <code class="code docutils literal notranslate"><span class="pre">&lt;a</span> <span class="pre">href=xxx&gt;</span></code> ，所以不写。
因噎废食大概就是这样吧。</p>
<div class="contents local topic" id="id2">
<ul class="simple">
<li><p><a class="reference internal" href="#id3" id="id25">漫长的选型</a></p></li>
<li><p><a class="reference internal" href="#id4" id="id26">我的需求</a></p>
<ul>
<li><p><a class="reference internal" href="#id5" id="id27">场景</a></p></li>
<li><p><a class="reference internal" href="#id7" id="id28">选型</a></p></li>
<li><p><a class="reference internal" href="#sphinx" id="id29">历史选择了 Sphinx</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id11" id="id30">系统架构</a></p>
<ul>
<li><p><a class="reference internal" href="#git" id="id31">Git</a></p></li>
<li><p><a class="reference internal" href="#neo-vim" id="id32">Neo(Vim)</a></p></li>
<li><p><a class="reference internal" href="#vim" id="id33">从终端和 Vim 快速访问</a></p></li>
<li><p><a class="reference internal" href="#id13" id="id34">描述、引用和索引</a></p></li>
<li><p><a class="reference internal" href="#id15" id="id35">博客</a></p></li>
<li><p><a class="reference internal" href="#sphinxnotes" id="id36">SphinxNotes 还有什么？</a></p></li>
<li><p><a class="reference internal" href="#id16" id="id37">其他扩展</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="id3">
<h2>漫长的选型<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h2>
<p>我并非没有在找合适的记录工具，大学时用 OneNote，在我还热衷于成为一个黑客的时候，我用 OneNotes 记下了几十篇 OllyDBG 的学习笔记。那时候云同步功能还不够好，在一次误操作中丢失了部分笔记，从此成为软黑。</p>
<p>后来 GitBook 流行起来，尝试用其管理笔记，缺点有三：</p>
<ul class="simple">
<li><p>太慢了</p></li>
<li><p>Markdown 表达力太孱弱，索引靠手写，引用靠 HTML 链接</p></li>
<li><p>打包非常恶心：我曾在 AUR 维护过 <a class="reference external" href="https://aur.archlinux.org/packages/nodejs-gitbook">📦nodejs-gitbook</a>，gitbook 提供了一个只许全局安装（Root 下而非 Home 下）的 gitbook-cli 作为安装器，而不允许用户单独安装 gitbook 本身：这让发行版的打包非常困难。</p></li>
</ul>
<p>2017 年我开始用 <a class="reference internal" href="use-sphinx-and-rst-to-manage-your-notes.html"><span class="doc">Sphinx 管理我的笔记</span></a> ，reStructuredText 已经很接近我心中理想的 markup language 的样子，结果刚建起一个框架便开始荒废。从那时到现在已经过去了四年，我记录下了些什么呢？——什么都没有</p>
<p>2020 年，3、4 月的时候我尝试用 Golang 从零开始写一个笔记软件，后来发现无论是设计和工作量都不是我单枪匹马能胜任的，最后只留下只有零星几个 commit 的仓库。</p>
<p>5 月，我建立了 <a class="reference external" href="https://github.com/SilverRainZ/bullet">⛺SilverRainZ/bullet</a> 仓库准备再试试 Sphinx，之后学画需要记 <a class="reference internal" href="../notes/zxsys/index.html"><span class="doc">大量的笔记</span></a>，将他们电子化也是一个强大的驱动力。</p>
<p>9 月的时候生病，居然也因祸得福，捡到了几个月的疗养时间。在家的时候里我好好学习了一下 Sphinx 和 Docutils，思考各种类型的文档要如何组织，尝试使用社区提供的 <a class="reference external" href="https://github.com/sphinx-contrib">各种扩展</a> 来增强文档的功能，再后来发现自己的需求社区并不能满足，便自己建立了一个一人社区 <a class="reference external" href="https://github.com/sphinx-notes">👥sphinx-notes</a>。</p>
<p>2021 年，在陆续完善一些关键的 <a href="#id38"><span class="problematic" id="id39">`Sphinx 扩展`_</span></a> 之后，我的笔记系统 <span class="sphinxnotes-strike">发出了响亮的第一声啼哭</span> 开始慢慢形成了。</p>
</section>
<section id="id4">
<h2>我的需求<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h2>
<p>在漫长的寻找中我慢慢明确了自己的需求，以及自己心目中的笔记系统是什么样子的。在提出需求之前，先来看看我的场景：</p>
<section id="id5">
<span id="id6"></span><h3>场景<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li><p>我希望 <em>笔记被良好分类且结构合理</em> ，对目录（Table Of Content）、交叉引用（Cross Reference）有大量需求</p>
<ul>
<li><p>我有一个 <a class="reference internal" href="../blog.html" title="Posts"><span class="xref std std-ref">博客</span></a>，我将它认为一种 <span class="sphinxnotes-strike">生产级别的</span> 笔记</p></li>
<li><p>有一些 <a class="reference internal" href="../misc/2021/index.html"><span class="doc">笔记</span></a> 天然地有碎片化的属性，我也需要他们能被合理组织</p></li>
</ul>
</li>
<li><p>我希望能 <em>结构化地描述笔记中的对象</em> ，并对它们进行引用、索引和分类，听起来有些强迫症但并非空穴来风：</p>
<ul>
<li><p>我经常画画，我用笔记来记录自己的 <a class="reference internal" href="../notes/zxsys/index.html"><span class="doc">绘画训练计划</span></a> ，其中包含大量的作品，我用统计的方式记录他们的日期、尺幅、媒介，例如：<a class="reference internal" href="../any-artworkmediumindex.html"><span class="std std-ref">Artwork Medium Reference Index</span></a></p></li>
<li><p>我在学艺术史，以艺术家为脉络的话，我可以建立这样的索引：<a class="reference internal" href="../any-artistindex.html"><span class="std std-ref">Artist  Reference Index</span></a></p></li>
<li><p>我的 <a class="reference internal" href="../any-friendindex.html"><span class="std std-ref">朋友们</span></a> 经常会出现在我的行文中，我想漂亮地 mention 到 TA，比如 <a class="reference internal" href="../about/friends.html#friend-quininer" title="friend quininer"><code class="xref any any-friend docutils literal notranslate"><span class="pre">👤quininer</span></code></a>，其实也是避免冗余的一个方式</p></li>
</ul>
</li>
<li><p>我是 Linux 用户（Arch Linux B.T.W），我在终端下工作，当然网页是现在最通用的界面了：<em>我需要我的笔记能在网页端和终端都能被良好地检索和浏览</em></p></li>
<li><p>我偏爱纯文本，作为曾经的 Mircosoft Word 的用户，我不喜欢复杂的富文本带来的难以预测的排版问题，以及兼容问题</p></li>
<li><p>我乐于折腾配置，我有一定的编程经验：我清楚自己的需求特殊，愿意为此折腾，包括写一些代码</p></li>
</ul>
</section>
<section id="id7">
<h3>选型<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h3>
<p>我将上面的场景尽量转化为一些指标用于选型：</p>
<dl>
<dt>使用纯文本</dt><dd><p>就编辑体验的一环来说，富文本往往绑定一个复杂的，羸弱（想想论坛编辑器）或者
难以预料的（想想 MS Word）的编辑器，这当然不能怪他们，富文本编辑真是是太难了</p>
<p>纯文本给我一种踏实感：</p>
<ul>
<li><p>不会产生冗余代码 – 你写什么它就是什么</p></li>
<li><p>不限制编辑器 – 我可以继续用 (Neo)Vim</p>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>其实不一定，看看 VimWiki、Org-mode</p>
</div>
</li>
<li><p>容易自动化地修改</p></li>
</ul>
</dd>
<dt>表达能力及格</dt><dd><p>笔记系统所使用的表达方式（Markup language、富文本）要有足够强的表达能力，对于书写中的常用格式（链接，引用，代码块、脚注、表格、提示、图片）都要有足够支持。</p>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>为什么不是「表达能力强」呢？</p>
<p>强实际上意味着集成度高，也意味着 Domain Specified，所有原生的 Markup language 都难以做到方方面面让人满意，笔记写多了总有自己的特殊需求，富文本里能打的可能只有也 OneNote 一个 —— 但我是不可能用的。</p>
<p>因此，够用就行—— 通过扩展让它变强。</p>
</div>
</dd>
<dt>标准可扩展</dt><dd><p>我希望我的笔记系统的表达能力的可以根据我的需要扩展的。
在前面的指标里为什么我不要求「表达能力强」呢？</p>
<ol class="arabic simple">
<li><p>强实际上意味着集成度高，和后面某一条指标相悖</p></li>
<li><p>强也意味着 Domain Specified，乎所有原生的 Markup language 都难以做到方方面面让人满意，笔记写多了总有自己的特殊需求，富文本里能打的可能只有也 OneNote 一个 —— 但我是不可能用的</p></li>
</ol>
<p>因此，够用就行—— 通过扩展让它变强，我希望这个系统原生地提供一个给我扩展的能力的借口。</p>
<p>我不喜欢所有使用 Markdown 方言的笔记软件，这是不「标准」的扩展方式。</p>
</dd>
<dt>自由开源</dt><dd><p>我不信任商业软件、共享软件：软件项目会倒闭，会改变定价，会做 breaking change，会停止维护——当然自由软件也会，只是你与社区并非无能为力</p>
</dd>
<dt>组件化</dt><dd><p>我希望我的系统最终是由多个组件组合而成的，组件化意味着 <em>复杂度被分摊到了不同的组件上</em> ，在未来某一个项目跑路的时候，我只需要寻找它那一部分的替代品就好了。</p>
</dd>
<dt>目的单纯</dt><dd><p>承上，在系统里负责解释和渲染笔记的核心组件几乎是不可替代的，那么我希望那个它是目的是单纯且稳定的。如果它还多做了很多事情。比如说发布系统、帐号体系、权限控制，甚至 APP 等，又或者它是某个庞大项目的附庸，那么我也倾向于不使用它。</p>
</dd>
</dl>
</section>
<section id="sphinx">
<h3>历史选择了 Sphinx<a class="headerlink" href="#sphinx" title="永久链接至标题">¶</a></h3>
<p>其实上面写一堆有些 <a class="reference external" href="https://zh.wikipedia.org/wiki/先射箭再画靶">📖先射箭再画靶</a> 的意思了，如题，最终我选择了 reStructuredText + Sphinx 作为笔记系统的核心。</p>
<p>现在介绍会不会太晚？</p>
<blockquote>
<div><p><a class="reference external" href="https://docutils.sourceforge.io/rst.html"><img alt="rst-badge" src="../_images/rst.png" style="height: 1em;" /></a> is an easy-to-read, what-you-see-is-what-you-get plaintext markup syntax and parser system. …  reStructuredText is designed for extensibility for specific application domains.  <a class="footnote-reference brackets" href="#id20" id="id8">2</a></p>
<p><a class="reference external" href="https://www.sphinx-doc.org"><img alt="sphinx-badge" src="../_images/sphinx.png" style="height: 4em;" /></a> Sphinx is a tool that makes it easy to create intelligent and beautiful documentation, written by Georg Brandl and licensed under the BSD license. It was originally created for the Python documentation, and it has excellent facilities for the documentation of software projects in a range of languages. <a class="footnote-reference brackets" href="#id21" id="id9">3</a></p>
</div></blockquote>
<p>针对上面的指标，reStructuredText（下称 reSt） + Sphinx 具有哪些优势呢？</p>
<ol class="arabic simple">
<li><p>reST 虽然稍显繁琐，但其表达能力非常优秀</p></li>
<li><p>reST 在语法上提供了灵活的扩展方式</p></li>
<li><p>Sphinx 作为 Python 官方的文档生产系统，久经考验，同时也被大量著名非 Python项目（Blender、DPDK、Linux Kernel）采用</p></li>
<li><p>Sphinx 提供了 <code class="code docutils literal notranslate"><span class="pre">..</span> <span class="pre">toctree::</span></code> 指令，能将文档以树状的形式组织起来</p></li>
<li><p>Sphinx 支持丰富的交叉引用功能</p></li>
<li><p>Sphinx 提供了 Domain 机制，为后续的 <a class="reference internal" href="#id13"><span class="std std-ref">描述、引用和索引</span></a> 提供了基础实现</p></li>
<li><p>Sphinx 在 reST 的基础上实现了有优秀的扩展机制，同时有 <a class="reference external" href="https://pypi.org/search/?q=sphinxcontrib">大量的现成的扩展</a> 可用</p></li>
</ol>
<p>除此之外，单纯靠 Sphinx 无法达到的指标，我用扩展 + 其他组件搞定，请继续往下。</p>
</section>
</section>
<section id="id11">
<h2>系统架构<a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h2>
<p>目前，我的笔记系统的架构是这样的（使用 <a class="reference external" href="https://pypi.org/project/sphinxcontrib-plantuml">📦sphinxcontrib-plantuml</a> 生成）：</p>
<figure class="align-default" id="id23">
<p class="plantuml">
<img src="../_images/plantuml-a9f385a4c905bb846652df7c0b3ce816a60e5423.png" alt="file &quot;HTML 文档&quot; as html

package &quot;Sphinx&quot; as sphinx {
   component &quot;Snippet 插件&quot; as snippet.ext
}
sphinx -u-&gt; html: 输出

folder &quot;Git 仓库&quot; {
   file &quot;Sphinx 配置&quot;
   file &quot;reStructuredText 文档&quot; as rst
}
rst -u-&gt; sphinx: 构建

cloud pages.github as &quot;Github Pages（主站）&quot;
cloud pages.gitee as &quot;Gittee Pages（镜像）&quot;
html -u-&gt; pages.github: git push
pages.github -&gt; pages.gitee: Github Action

file &quot;Snippet 索引&quot;  as snippet.cache
agent &quot;Snippet 命令行工具&quot; as snippet.cli
snippet.cli .u.&gt; snippet.cache: 读取
snippet.ext .d.&gt; snippet.cache: 写入
snippet.cli -u-&gt; html: 浏览
snippet.cli -u-&gt; rst: 浏览，编辑

node shell as &quot;Z Shell&quot;
node editor as &quot;Neo(vim)&quot;
shell -u-&gt; snippet.cli: 浏览，编辑
editor -u-&gt; snippet.cli: 浏览，编辑"/>
</p>
<figcaption>
<p><span class="caption-text">Bullet 笔记系统架构</span><a class="headerlink" href="#id23" title="永久链接至图片">¶</a></p>
</figcaption>
</figure>
<section id="git">
<h3>Git<a class="headerlink" href="#git" title="永久链接至标题">¶</a></h3>
<p>如图，我用 Git 来管理整个 Sphinx 项目的版本，用 GitLFS 管理图片资源（后来因为 gitee 不支持又去掉了），仓库沿用之前建立的 <a class="reference external" href="https://github.com/SilverRainZ/bullet">⛺SilverRainZ/bullet</a> 上。</p>
<p>一般来说 Sphinx 文档都会托管到 <a class="reference external" href="https://readthedocs.io">ReadTheDocs</a>，出于部署速度的访问速度的要求，我基于 GitHub Action 写了 <a class="reference external" href="https://github.com/sphinxnotes/pages">⛺sphinxnotes/pages</a> 用来自动部署 Sphinx 文档到 GitHub Pages，并使用 <a class="reference external" href="https://github.com/spyoungtech/mirror-action">⛺spyoungtech/mirror-action</a> 和 <a class="reference external" href="https://github.com/yanglbme/gitee-pages-action">⛺yanglbme/gitee-pages-action</a> 建立了国内的 Gitee 镜像。</p>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>Github 和其他托管平台会在 Languages 统计时忽略常见的 Markup Languages（如 Markdown、restructuredText），为了让它能被统计 ，可以建立 <code class="file docutils literal notranslate"><span class="pre">.gitattributes</span></code> 文件加入以下内容 <a class="footnote-reference brackets" href="#id22" id="id12">4</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*.</span><span class="n">rst</span> <span class="n">linguist</span><span class="o">-</span><span class="n">detectable</span><span class="o">=</span><span class="n">true</span>
</pre></div>
</div>
<p>在 GitHub 上可以看到 reStructuredText 被正确统计了：</p>
<img alt="../_images/rst-language-stat.png" src="../_images/rst-language-stat.png" />
</div>
</section>
<section id="neo-vim">
<h3>Neo(Vim)<a class="headerlink" href="#neo-vim" title="永久链接至标题">¶</a></h3>
<p>我用 Neovim 编辑 reST 文件，关于如何在舒服地用 (Neo)vim 写 reST，我会再写一篇文章展开。</p>
</section>
<section id="vim">
<h3>从终端和 Vim 快速访问<a class="headerlink" href="#vim" title="永久链接至标题">¶</a></h3>
<p>浏览器、Vim 和终端模拟器是我最常待的 workspace，前者当然可以方便的访问 Sphinx 生产的 HTML 文档，为了从后两者操作文档的需求，我写了 <a class="reference external" href="https://pypi.org/project/sphinxnotes-snippet">📦sphinxnotes-snippet</a> ，包含一个 Sphinx 扩展和一个命令行工具。</p>
<dl class="simple">
<dt>Snippet 扩展</dt><dd><p>会在构建文档的时候：</p>
<ol class="arabic simple">
<li><p>自动提取文档片段：标题、代码、图片、段落等</p></li>
<li><p>中英文分词</p></li>
<li><p>简单地 normalize</p></li>
<li><p>提取关键字</p></li>
<li><p>中文转化为拼音</p></li>
<li><p>建立到文档的索引</p></li>
<li><p>然后保存在磁盘上待检索。</p></li>
</ol>
</dd>
<dt>Snippet 命令行工具</dt><dd><p>本身提供了简介强大命令行接口用以访问上述的索引，基于此在 Zsh 和 Neovim 实现了对应的插件：</p>
<ul class="simple">
<li><p>按下快捷键 <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">C</kbd>-<kbd class="kbd docutils literal notranslate">k</kbd></kbd>，后续一个按键给出操作方式：
<kbd class="kbd docutils literal notranslate">v</kbd> 浏览、<kbd class="kbd docutils literal notranslate">e</kbd> 编辑、<kbd class="kbd docutils literal notranslate">u</kbd> 打开 URL</p></li>
<li><p>在 <a class="reference external" href="https://github.com/junegunn/fzf">Fzf</a> 中输入关键词以筛选文档片段，支持拼音</p></li>
<li><p>对你选中的文档片段执行指定操作</p></li>
</ul>
</dd>
</dl>
<p>在这之前我「检索外脑」的延迟为 <em>数十秒</em> ，根据所在 workspace的不同有不同的操作：</p>
<dl>
<dt>在浏览器</dt><dd><p>打开主站或者 Gitee 镜像</p>
<ul>
<li><p>根据记忆中的笔记结构一层层点进去</p></li>
<li><p>使用 Sphinx 的内建搜索</p>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>事实上 Sphinx 内建的搜索不支持中文分词，因此实用程度基本为零</p>
</div>
</li>
</ul>
</dd>
<dt>在 Vim</dt><dd><p>根据记忆中的笔记结构，打开 NERDTree 的侧边栏一层层展开</p>
</dd>
<dt>在终端</dt><dd><ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">cd</span></code> 到笔记所在目录执行 <code class="code docutils literal notranslate"><span class="pre">grep</span> <span class="pre">-r</span> <span class="pre">关键字</span></code>，然而笔记中文内容居多（一段时间内我甚至在考虑要不要用英文记笔记方便检索）</p></li>
<li><p>根据记忆中的笔记结构一层层 <code class="code docutils literal notranslate"><span class="pre">cd</span></code> 进去，用 Vim 浏览</p></li>
</ul>
</dd>
</dl>
<p>在使用 Snippet 后这一过程可以压缩到一秒内：</p>
<dl class="simple">
<dt>在浏览器</dt><dd><p>切换到 Vim 或者终端</p>
</dd>
<dt>在 Vim</dt><dd><p>唤醒 Snippet，输入关键词，</p>
</dd>
<dt>在终端</dt><dd><p>唤醒 Snippet，输入关键词，</p>
</dd>
</dl>
<p>这一时间的压缩让检索的实用性大大提升：检索一些总记不住的命令已经比开 Google 快了
此外，编写编辑的时候，在不同笔记之间的跳转也流畅许多。</p>
<p>关于 Snippet 的使用，我也会再写一篇文章展开，配合其他工具有非常多的玩法。</p>
</section>
<section id="id13">
<span id="id14"></span><h3>描述、引用和索引<a class="headerlink" href="#id13" title="永久链接至标题">¶</a></h3>
<p>除了上述的 Snippet，另一个非常实用的扩展是 <a class="reference external" href="https://pypi.org/project/sphinxnotes-any">📦sphinxnotes-any</a></p>
</section>
<section id="id15">
<h3>博客<a class="headerlink" href="#id15" title="永久链接至标题">¶</a></h3>
<p>博客是最难办的一件事情，单纯靠安排笔记的接口可以让它看起来像一个博客，但关键的
目录、标签、归档、评论功能统统都没有。好在这件事情已经有人做了，并且做得非常舒服，非常符合 Sphinx 的哲学：</p>
<dl class="field-list simple">
<dt class="field-odd">ghorg:sunpy</dt>
<dd class="field-odd"><p>社区写了一个叫 <a class="reference external" href="https://pypi.org/project/ablog">📦ablog</a> 的扩展，用来在 Sphinx 里建立博客，保持兼容最新版的 Sphinx 为目标，开发也非常活跃。你可以看看 ABlog 在我的笔记系统上的效果：<a class="reference internal" href="../blog.html" title="Posts"><em>Posts</em></a></p>
</dd>
</dl>
<p>ABlog 支持 Disqus 评论，如果你想用 Self-hosted 的 <a class="reference external" href="https://posativ.org/isso/">Isso</a> 的话，可以试试我写的 <a class="reference external" href="https://pypi.org/project/sphinxnotes-isso">📦sphinxnotes-isso</a>，文章底部可以看到 Isso 的评论框。</p>
<p>值得一提的是，Sphinx 的 sidebar 并不是全局的，可以用 glob pattern 让不同的页面用不同的，因此可以让 ABlog 引入的博客侧边栏不会影响现有的其他的文档：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">standard_page</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;about.html&#39;</span><span class="p">,</span> <span class="s1">&#39;localtoc.html&#39;</span><span class="p">,</span> <span class="s1">&#39;searchbox.html&#39;</span><span class="p">]</span>
<span class="n">blog_post_page</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;about.html&#39;</span><span class="p">,</span> <span class="s1">&#39;postcard.html&#39;</span><span class="p">,</span> <span class="s1">&#39;localtoc.html&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;recentposts.html&#39;</span><span class="p">,</span> <span class="s1">&#39;tagcloud.html&#39;</span><span class="p">,</span> <span class="s1">&#39;categories.html&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;archives.html&#39;</span><span class="p">,</span> <span class="s1">&#39;searchbox.html&#39;</span><span class="p">]</span>

<span class="n">html_sidebars</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;blog&#39;</span><span class="p">:</span> <span class="n">blog_post_page</span><span class="p">,</span> <span class="c1"># ABlog&#39;s &quot;All Posts&quot; page</span>
    <span class="s1">&#39;blog/**&#39;</span><span class="p">:</span> <span class="n">blog_post_page</span><span class="p">,</span> <span class="c1"># Inlucde posts and autogenerated pages</span>
<span class="p">}</span>
</pre></div>
</div>
<p>两种 sidebar 对比如图：</p>
<figure class="align-default" id="id24">
<img alt="../_images/sphinx-sidebar-with-without-ablog.png" src="../_images/sphinx-sidebar-with-without-ablog.png" />
<figcaption>
<p><span class="caption-text">左：默认 sidebar，右：博客 sidebar</span><a class="headerlink" href="#id24" title="永久链接至图片">¶</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>比较遗憾的是，之前使用的 sphinx_rtd_theme 并不听 Sphinx 的 sidebar 配置 只能换成了默认的 Alabaster theme</p>
</div>
</section>
<section id="sphinxnotes">
<h3>SphinxNotes 还有什么？<a class="headerlink" href="#sphinxnotes" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li><p>用 LilyPond + <a class="reference external" href="https://pypi.org/project/sphinx-notes-lilypond">📦sphinx-notes-lilypond</a> 来显示音符 <img class="lilypond-score" src=".././_lilypond/fe054cc0f6577b37cbee4644af6855a6ff620a5c/music.preview.png" alt="\relative { c' }" align="absbottom"/>  和 <a class="reference internal" href="../collections/scores/index.html"><span class="doc">带试听音频的乐谱</span></a></p></li>
<li><p><a class="reference external" href="https://pypi.org/project/sphinxnotes-strike">📦sphinxnotes-strike</a> 提供了 <code class="code docutils literal notranslate"><span class="pre">del</span></code> role 用来显示 reST 不支持的 <span class="sphinxnotes-strike">删除线</span></p></li>
</ul>
</section>
<section id="id16">
<h3>其他扩展<a class="headerlink" href="#id16" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li><p>用 <code class="code docutils literal notranslate"><span class="pre">sphinx.ext.extlink</span></code> 来方便地生成外部链接</p></li>
<li><p>用 <code class="code docutils literal notranslate"><span class="pre">sphinx.ext.graphviz</span></code> 和 <a class="reference external" href="https://pypi.org/project/sphinxcontrib-plantuml">📦sphinxcontrib-plantuml</a> 来各种图表</p></li>
<li><p>用 <a class="reference external" href="https://github.com/executablebooks/sphinx-panels">⛺executablebooks/sphinx-panels</a> 提供 reST 不支持的分栏功能，顺便还享用了它内置的 <span class="fa fa-font"></span> Font Awesome 支持</p></li>
</ul>
<div class="admonition-todo admonition" id="id17">
<p class="admonition-title">待处理</p>
<p>see conf.py</p>
</div>
<p class="rubric">脚注</p>
<dl class="footnote brackets">
<dt class="label" id="id18"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>和 <a class="reference internal" href="../about/friends.html#friend-VOID001" title="friend VOID001"><code class="xref any any-friend docutils literal notranslate"><span class="pre">👤VOID001</span></code></a> 的 <a class="reference external" href="https://void-shana.moe/linux/zh-taking-notes-with-vim.html#comment-530">对话节选</a></p>
</dd>
<dt class="label" id="id20"><span class="brackets"><a class="fn-backref" href="#id8">2</a></span></dt>
<dd><p><a class="reference external" href="https://docutils.sourceforge.io/rst.html">https://docutils.sourceforge.io/rst.html</a></p>
</dd>
<dt class="label" id="id21"><span class="brackets"><a class="fn-backref" href="#id9">3</a></span></dt>
<dd><p><a class="reference external" href="https://www.sphinx-doc.org">https://www.sphinx-doc.org</a></p>
</dd>
<dt class="label" id="id22"><span class="brackets"><a class="fn-backref" href="#id12">4</a></span></dt>
<dd><p><a class="reference internal" href="../man/git.html"><span class="doc">Git</span></a></p>
</dd>
</dl>
<hr class="docutils" />
<section data-isso-id="/blog/sphinx-as-note-taking-system" data-title="我如何用 Sphinx 建立笔记系统（一）选择 Sphinx 的理由" id="isso-thread"></section></section>
</section>
</section>

<div class="section">
       
</div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">Yes silver bullet here.</p>






  
<h2>
   <i
    class="fa fa-pencil"
  ></i
  >  Draft  
</h2>

<ul>
   
<li id="author">
  <span
    ><i class="fa-fw fa fa-user"></i></span
  >
   
  <a href="author/shengyu-zhang.html">Shengyu Zhang</a>  
</li>
  
<li id="language">
  <span
    ><i class="fa-fw fa fa-language"></i></span
  >
   
  <a href="language/%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87.html">简体中文</a>  
</li>
 
<li id="category">
  <span
    ><i class="fa-fw fa fa-folder-open"></i></span
  >
   我如何用 Sphinx 建立笔记系统 
</li>
 
<li id="tags">
  <span
    ><i
      class="fa-fw fa fa-tag"
    ></i
    ></span
  >
   Draft 
</li>
 
</ul>

  <h3><a href="../index.html">目录</a></h3>
  <ul>
<li><a class="reference internal" href="#">我如何用 Sphinx 建立笔记系统（一）选择 Sphinx 的理由</a><ul>
<li><a class="reference internal" href="#id3">漫长的选型</a></li>
<li><a class="reference internal" href="#id4">我的需求</a><ul>
<li><a class="reference internal" href="#id5">场景</a></li>
<li><a class="reference internal" href="#id7">选型</a></li>
<li><a class="reference internal" href="#sphinx">历史选择了 Sphinx</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id11">系统架构</a><ul>
<li><a class="reference internal" href="#git">Git</a></li>
<li><a class="reference internal" href="#neo-vim">Neo(Vim)</a></li>
<li><a class="reference internal" href="#vim">从终端和 Vim 快速访问</a></li>
<li><a class="reference internal" href="#id13">描述、引用和索引</a></li>
<li><a class="reference internal" href="#id15">博客</a></li>
<li><a class="reference internal" href="#sphinxnotes">SphinxNotes 还有什么？</a></li>
<li><a class="reference internal" href="#id16">其他扩展</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<h3>
  <a href="../blog.html">Recent Posts</a>
</h3>
<ul>
   
  <li>
    <a href="new-boy.html"
      >21 March - 嘿，我去 2010</a
    >
  </li>
  
  <li>
    <a href="from-jekyll-to-sphinx.html"
      >26 December - 博客迁移到 Sphinx</a
    >
  </li>
  
  <li>
    <a href="srain-and-me.html"
      >29 February - Srain 1.0 发布了</a
    >
  </li>
  
  <li>
    <a href="switch-from-duoshuo-to-isso.html"
      >10 June - 从多说迁移到 Isso</a
    >
  </li>
  
  <li>
    <a href="use-sphinx-and-rst-to-manage-your-notes.html"
      >29 March - 用 Sphinx + reStructuredText 构建笔记系统</a
    >
  </li>
  
</ul>

<h3><a href="tag.html">Tags</a></h3>
<style type="text/css">
  ul.ablog-cloud {
    list-style: none;
    overflow: auto;
  }
  ul.ablog-cloud li {
    float: left;
    height: 20pt;
    line-height: 18pt;
    margin-right: 5px;
  }
  ul.ablog-cloud a {
    text-decoration: none;
    vertical-align: middle;
  }
  li.ablog-cloud-1 {
    font-size: 80%;
  }
  li.ablog-cloud-2 {
    font-size: 95%;
  }
  li.ablog-cloud-3 {
    font-size: 110%;
  }
  li.ablog-cloud-4 {
    font-size: 125%;
  }
  li.ablog-cloud-5 {
    font-size: 140%;
  }
</style>
<ul class="ablog-cloud">
   
  <li class="ablog-cloud ablog-cloud-2">
    <a href="tag/c.html">C</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-3">
    <a href="tag/ctf.html">CTF</a>
  </li>
      
  <li class="ablog-cloud ablog-cloud-2">
    <a href="tag/gsoc.html">GSoC</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="tag/gtk.html">GTK</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-5">
    <a href="tag/haskell.html">Haskell</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="tag/irc.html">IRC</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="tag/isso.html">Isso</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-2">
    <a href="tag/linux.html">Linux</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="tag/makefile.html">Makefile</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-2">
    <a href="tag/os.html">OS</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="tag/python.html">Python</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="tag/python-sphinx.html">Python Sphinx</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-3">
    <a href="tag/reverse.html">Reverse</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="tag/sphinx.html">Sphinx</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="tag/srain.html">Srain</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="tag/teeworlds.html">Teeworlds</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="tag/vim.html">Vim</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="tag/windows.html">Windows</a>
  </li>
      
  <li class="ablog-cloud ablog-cloud-1">
    <a href="tag/restructuredtext.html">reStructuredText</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="tag/%E5%A4%9A%E8%AF%B4.html">多说</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="tag/%E7%94%9F%E6%B4%BB.html">生活</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="tag/%E7%9E%8E%E6%89%AF.html">瞎扯</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="tag/%E8%AE%BE%E5%A4%87.html">设备</a>
  </li>
   
</ul>

<h3>
  <a href="archive.html">Archives</a>
</h3>
<ul>
   
  <li>
    <a href="2021.html">2021 (1)</a>
  </li>
    
  <li>
    <a href="2020.html">2020 (2)</a>
  </li>
    
  <li>
    <a href="2017.html">2017 (2)</a>
  </li>
    
  <li>
    <a href="2016.html">2016 (6)</a>
  </li>
    
  <li>
    <a href="2015.html">2015 (18)</a>
  </li>
   
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020-2021, Shengyu Zhang.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>